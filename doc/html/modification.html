<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Voxels Library: Surface modification</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Voxels Library
   &#160;<span id="projectnumber">0.5</span>
   </div>
   <div id="projectbrief">Voxel grid manipulation and surface generation library (c) 2014 Stoyan Nikolov</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('modification.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Surface modification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Voxels</b> supports efficient ways to modify the Grid and hence the surface in real-time. The modification procedures are very fast, so that lag is not perceived by the user between the time she modifies the surface and sees the result.</p>
<h2>Changing the grid</h2>
<p>The first step of the modification is changing the <em>Grid</em>. There are three ways to do this. The <em>Grid</em> is virtually subdivided in blocks 16x16x16 voxels each. These blocks are kept compressed in memory but are modifiable by the user. The <em><a class="el" href="class_voxels_1_1_grid.html#ab83e66597b0be46542742bb4d3e6f070">Voxels::Grid::GetBlockDistanceData</a></em>, <em><a class="el" href="class_voxels_1_1_grid.html#ad3cc3846c9d7f89de21dcfd59ac794a0">Voxels::Grid::ModifyBlockDistanceData</a></em>, <em><a class="el" href="class_voxels_1_1_grid.html#ac70c56fc2701731609434326cbe8f0a9">Voxels::Grid::GetBlockMaterialData</a></em>, <em><a class="el" href="class_voxels_1_1_grid.html#a8fb698d9513e3fc4f40f2e2b06607337">Voxels::Grid::ModifyBlockMaterialData</a></em> methods allow reading and changing the values of whole blocks.</p>
<p>Two more convenience methods are provided to change the grid: <em><a class="el" href="class_voxels_1_1_grid.html#a72288348e35c74366c05bb2e61f2f987">Voxels::Grid::InjectSurface</a></em> and <em><a class="el" href="class_voxels_1_1_grid.html#a9269f3efd21ecf0339769c8b7f077266">Voxels::Grid::InjectMaterial</a></em>. As their names imply, they allow the user to inject in the Grid a surface (an implementer of the <em><a class="el" href="class_voxels_1_1_voxel_surface.html">Voxels::VoxelSurface</a></em> interface) and a material in a specified position in the grid with specified extents. The returned pair of float triplets represent the extents of the modified region inside the grid.</p>
<p><b>Note:</b> In <em>Grid</em> coordinates the <em>z</em> component is the <em>up</em> direction - the one linked to the <em>height</em> value.</p>
<h2>Polygonizing the change</h2>
<p>Re-polygonizing the whole surface when just some part of it has changed is overkill. <b>Voxels</b> supports computing just parts the of the surface that have changed. This makes the modification process extremely fast and suitable for real-time.</p>
<p>The <em><a class="el" href="class_voxels_1_1_polygonizer.html#a653261f80031e15e0290f8969766b6c9">Voxels::Polygonizer::Execute</a></em> can take as last parameter a pointer to a <em><a class="el" href="struct_voxels_1_1_modification.html">Voxels::Modification</a></em> object that encapsulates information about exactly what part of the grid has changed and which surface we are modifying.</p>
<div class="fragment"><div class="line"><a class="code" href="struct_voxels_1_1_modification.html">Voxels::Modification</a>* modification = <a class="code" href="struct_voxels_1_1_modification.html#a0ec798e41876e3602a8964b7e8459090">Voxels::Modification::Create</a>();</div>
<div class="line"><span class="keywordflow">if</span>(modified) {</div>
<div class="line">    modification-&gt;<a class="code" href="struct_voxels_1_1_modification.html#a4c333393d80df41fb8fd0aa72b637202">Map</a> = m_PolygonSurface;</div>
<div class="line">    modification-&gt;<a class="code" href="struct_voxels_1_1_modification.html#a8bf8073d109b5177d9f9e98a5a375bc0">MinCornerModified</a> = modified-&gt;first;</div>
<div class="line">    modification-&gt;<a class="code" href="struct_voxels_1_1_modification.html#a30c5f667c8457f7bb6a1ee4927ca02c8">MaxCornerModified</a> = modified-&gt;second;</div>
<div class="line">}</div>
<div class="line">m_PolygonSurface = m_Polygonizer-&gt;Execute(*m_Grid, &amp;m_Materials, modification);</div>
<div class="line"></div>
<div class="line">modification-&gt;<a class="code" href="struct_voxels_1_1_modification.html#ab605709982909fe4701588b49407d9a9">Destroy</a>();</div>
</div><!-- fragment --><p>The <em><a class="el" href="class_voxels_1_1_polygon_surface.html">Voxels::PolygonSurface</a></em> object contains a cache that aids modification performance. If you intend to modify a grid you should keep it around and pass it back to the <em>Polygonizer</em> upon modification. After the procedure has completed you'll get an updated <em><a class="el" href="class_voxels_1_1_polygon_surface.html">Voxels::PolygonSurface</a></em> object.</p>
<p><b>Note:</b> The Polygonizer produces vertices with the <em>y</em> component as <em>up</em>, which is usually the norm for most realtime graphics applications.</p>
<p>After a modification some block might change, others might disappear and new ones get created. The application should keep track of the previous block ids in each level and diff this collection with the new state of the <em><a class="el" href="class_voxels_1_1_polygon_surface.html">Voxels::PolygonSurface</a></em> object. Each block has a unique id that can be used to identify it. GPU data related to blocks that don't appear in the new <em><a class="el" href="class_voxels_1_1_polygon_surface.html">Voxels::PolygonSurface</a></em> object should be deleted. Newly created ones should be uploaded to the GPU. A function that performs this operation is <em>DrawRoutine::UpdateGrid</em> found in the <em>VolumeRendering</em> sample and can be used as reference. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Feb 10 2014 21:24:20 for Voxels Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
